Manipulating	B-TTPs
Opaque	I-TTPs
Client-based	I-TTPs
Data	I-TTPs
Tokens	I-TTPs
In	O
circumstances	O
where	O
an	O
application	O
holds	O
important	O
data	O
client-side	O
in	O
tokens	O
(	O
cookies	O
","	O
URLs	O
","	O
data	O
files	O
","	O
and	O
so	O
forth	O
)	O
that	O
data	O
can	O
be	O
manipulated	O
.	O
If	O
client	O
or	O
server-side	O
application	O
components	O
reinterpret	O
that	O
data	O
as	O
authentication	O
tokens	O
or	O
data	O
(	O
such	O
as	O
store	O
item	O
pricing	O
or	O
wallet	O
information	O
)	O
then	O
even	O
opaquely	O
manipulating	O
that	O
data	O
may	O
bear	O
fruit	O
for	O
an	O
Attacker	O
.	O
In	O
this	O
pattern	O
an	O
attacker	O
undermines	O
the	O
assumption	O
that	O
client	O
side	O
tokens	O
have	O
been	O
adequately	O
protected	O
from	O
tampering	O
through	O
use	O
of	O
encryption	O
or	O
obfuscation	O
.	O
An	O
attacker	O
already	O
has	O
some	O
access	O
to	O
the	O
system	O
or	O
can	O
steal	B-TTPs
the	I-TTPs
client	I-TTPs
based	I-TTPs
data	I-TTPs
tokens	I-TTPs
from	I-TTPs
another	I-TTPs
user	I-TTPs
who	I-TTPs
has	I-TTPs
access	I-TTPs
to	I-TTPs
the	I-TTPs
system	I-TTPs
.	O
For	O
an	O
Attacker	O
to	O
viably	O
execute	O
this	O
attack	O
","	O
some	O
data	O
(	O
later	O
interpreted	O
by	O
the	O
application	O
)	O
must	O
be	O
held	O
client-side	O
in	O
a	O
way	O
that	O
can	O
be	O
manipulated	O
without	O
detection	O
.	O
This	O
means	O
that	O
the	O
data	O
or	O
tokens	O
are	O
not	O
CRCd	O
as	O
part	O
of	O
their	O
value	O
or	O
through	O
a	O
separate	O
meta-data	O
store	O
elsewhere	O
.	O
One	O
solution	O
to	O
this	O
problem	O
is	O
to	O
protect	O
encrypted	O
data	O
with	O
a	O
CRC	O
of	O
some	O
sort	O
.	O
If	O
knowing	O
who	O
last	O
manipulated	O
the	O
data	O
is	O
important	O
","	O
then	O
using	O
a	O
cryptographic	O
``	O
message	O
authentication	O
code	O
''	O
(	O
or	O
hMAC	O
)	O
is	O
prescribed	O
.	O
However	O
","	O
this	O
guidance	O
is	O
not	O
a	O
panacea	O
.	O
In	O
particular	O
","	O
any	O
value	O
created	O
by	O
(	O
and	O
therefore	O
encrypted	O
by	O
)	O
the	O
client	O
","	O
which	O
itself	O
is	O
a	O
``	O
malicious	O
''	O
value	O
","	O
all	O
the	O
protective	O
cryptography	O
in	O
the	O
world	O
ca	O
n't	O
make	O
the	O
value	O
'correct	O
'	O
again	O
.	O
Put	O
simply	O
","	O
if	O
the	O
client	O
has	O
control	O
over	O
the	O
whole	O
process	O
of	O
generating	O
and	O
encoding	O
the	O
value	O
","	O
then	O
simply	O
protecting	O
its	O
integrity	O
does	O
n't	O
help	O
.	O
Make	O
sure	O
to	O
protect	O
client	O
side	O
authentication	O
tokens	O
for	O
confidentiality	O
(	O
encryption	O
)	O
and	O
integrity	O
(	O
signed	O
hash	O
)	O
Make	O
sure	O
that	O
all	O
session	O
tokens	O
use	O
a	O
good	O
source	O
of	O
randomness	O
Perform	O
validation	O
on	O
the	O
server	O
side	O
to	O
make	O
sure	O
that	O
client	O
side	O
data	O
tokens	O
are	O
consistent	O
with	O
what	O
is	O
expected	O
.	O
