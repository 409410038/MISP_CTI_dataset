PowerShell
script
runs
via
the
Task
Scheduler
and
downloads
the
lgntoerr.gif
file
from
a
remote
server
.
The
script
decrypts
lgntoerr.gif
,
resulting
in
a
.NET
DLL
,
which
is
then
loaded
.
The
.NET
DLL
extracts
and
decrypts
three
files
from
its
resources
:
two
DLLs
and
an
encrypted
payload
.
The
extracted
files
are
placed
in
the
ProgramData
directory
.
The
.NET
DLL
creates
a
task
to
autorun
the
legitimate
ilasm.exe
component
at
system
startup
via
Task
Scheduler
.
Task
Scheduler
starts
ilasm.exe
from
the
ProgramData
directory
.
ilasm.exe
launches
fusion.dll
,
a
malicious
DLL
hijacker
,
from
the
same
directory
.
fusion.dll
loads
the
second
decrypted
DLL
.
That
DLL
creates
a
suspended
dllhost.exe
process
.
It
then
decrypts
the
payload
from
the
encrypted
binary
file
.
The
decrypted
payload
is
loaded
into
the
dllhost.exe
process
as
a
DLL
.
The
PID
of
the
dllhost.exe
process
is
saved
to
a
file
in
the
ProgramData
directory
.
The
dllhost.exe
process
passes
control
to
the
decrypted
payload
.
The
payload
DLL
extracts
and
launches
the
miner
DLL
in
memory
.
