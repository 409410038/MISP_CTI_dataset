An	O
attacker	O
changes	O
the	O
behavior	O
or	O
state	O
of	O
a	O
targeted	O
application	O
through	O
injecting	B-TTPs
data	I-TTPs
or	I-TTPs
command	I-TTPs
syntax	I-TTPs
through	O
the	O
targets	O
use	O
of	O
non-validated	O
and	O
non-filtered	O
arguments	O
of	O
exposed	O
services	O
or	O
methods	O
.	O
Target	O
software	O
fails	O
to	O
strip	O
all	O
user-supplied	O
input	O
of	O
any	O
content	O
that	O
could	O
cause	O
the	O
shell	O
to	O
perform	O
unexpected	O
actions	O
.	O
Software	O
must	O
allow	O
for	O
unvalidated	B-Vulnerability
or	I-Vulnerability
unfiltered	I-Vulnerability
input	I-Vulnerability
to	O
be	O
executed	O
on	O
operating	O
system	O
shell	O
","	O
and	O
","	O
optionally	O
","	O
the	O
system	O
configuration	O
must	O
allow	O
for	O
output	O
to	O
be	O
sent	O
back	O
to	O
client	O
.	O
Design	O
:	O
Do	O
not	O
program	O
input	O
values	O
directly	O
on	O
command	O
shell	O
","	O
instead	O
treat	O
user	O
input	O
as	O
guilty	O
until	O
proven	O
innocent	O
.	O
Build	O
a	O
function	O
that	O
takes	O
user	O
input	O
and	O
converts	O
it	O
to	O
applications	O
specific	O
types	O
and	O
values	O
","	O
stripping	O
or	O
filtering	O
out	O
all	O
unauthorized	O
commands	O
and	O
characters	O
in	O
the	O
process	O
.	O
Design	O
:	O
Limit	O
program	O
privileges	O
","	O
so	O
if	O
metacharacters	O
or	O
other	O
methods	O
circumvent	O
program	O
input	O
validation	O
routines	O
and	O
shell	O
access	O
is	O
attained	O
then	O
it	O
is	O
not	O
running	O
under	O
a	O
privileged	O
account	O
.	O
chroot	O
jails	O
create	O
a	O
sandbox	O
for	O
the	O
application	O
to	O
execute	O
in	O
","	O
making	O
it	O
more	O
difficult	O
for	O
an	O
attacker	O
to	O
elevate	B-TTPs
privilege	I-TTPs
even	O
in	O
the	O
case	O
that	O
a	O
compromise	O
has	O
occurred	O
.	O
Implementation	O
:	O
Implement	O
an	O
audit	O
log	O
that	O
is	O
written	O
to	O
a	O
separate	O
host	O
","	O
in	O
the	O
event	O
of	O
a	O
compromise	O
the	O
audit	O
log	O
may	O
be	O
able	O
to	O
provide	O
evidence	O
and	O
details	O
of	O
the	O
compromise	O
.	O
