This	O
attack	O
targets	O
the	O
encoding	B-TTPs
of	I-TTPs
the	I-TTPs
URL	I-TTPs
.	O
An	O
attacker	O
can	O
take	B-TTPs
advantage	I-TTPs
of	I-TTPs
the	I-TTPs
multiple	I-TTPs
way	I-TTPs
of	I-TTPs
encoding	I-TTPs
an	I-TTPs
URL	I-TTPs
and	O
abuse	B-TTPs
the	I-TTPs
interpretation	I-TTPs
of	I-TTPs
the	I-TTPs
URL	I-TTPs
.	O
An	O
URL	O
may	O
contain	O
special	O
character	O
that	O
need	O
special	O
syntax	O
handling	O
in	O
order	O
to	O
be	O
interpreted	O
.	O
Special	O
characters	O
are	O
represented	O
using	O
a	O
percentage	O
character	O
followed	O
by	O
two	O
digits	O
representing	O
the	O
octet	O
code	O
of	O
the	O
original	O
character	O
(	O
%	O
HEX-CODE	O
)	O
.	O
For	O
instance	O
US-ASCII	O
space	O
character	O
would	O
be	O
represented	O
with	O
%	O
20	O
.	O
This	O
is	O
often	O
referred	O
as	O
escaped	O
ending	O
or	O
percent-encoding	O
.	O
Since	O
the	O
server	O
decodes	O
the	O
URL	O
from	O
the	O
requests	O
,	O
it	O
may	O
restrict	O
the	O
access	O
to	O
some	O
URL	O
paths	O
by	O
validating	O
and	O
filtering	O
out	O
the	O
URL	O
requests	O
it	O
received	O
.	O
An	O
attacker	O
will	O
try	O
to	O
craft	B-TTPs
an	I-TTPs
URL	I-TTPs
with	I-TTPs
a	I-TTPs
sequence	I-TTPs
of	I-TTPs
special	I-TTPs
characters	I-TTPs
which	I-TTPs
once	I-TTPs
interpreted	I-TTPs
by	I-TTPs
the	I-TTPs
server	I-TTPs
will	I-TTPs
be	I-TTPs
equivalent	I-TTPs
to	I-TTPs
a	I-TTPs
forbidden	I-TTPs
URL	I-TTPs
.	O
It	O
can	O
be	O
difficult	O
to	O
protect	O
against	O
this	O
attack	O
since	O
the	O
URL	O
can	O
contain	O
other	O
format	O
of	O
encoding	O
such	O
as	O
UTF-8	O
encoding	O
,	O
Unicode-encoding	O
,	O
etc	O
.	O
The	O
attacker	O
could	O
also	O
subvert	B-TTPs
the	I-TTPs
meaning	I-TTPs
of	I-TTPs
the	I-TTPs
URL	I-TTPs
string	I-TTPs
request	I-TTPs
by	O
encoding	B-TTPs
the	I-TTPs
data	I-TTPs
being	I-TTPs
sent	I-TTPs
to	I-TTPs
the	I-TTPs
server	I-TTPs
through	I-TTPs
a	I-TTPs
GET	I-TTPs
request	I-TTPs
.	O
For	O
instance	O
an	O
attacker	O
may	O
subvert	B-TTPs
the	I-TTPs
meaning	I-TTPs
of	I-TTPs
parameters	I-TTPs
used	I-TTPs
in	I-TTPs
a	I-TTPs
SQL	I-TTPs
request	I-TTPs
and	I-TTPs
sent	I-TTPs
through	I-TTPs
the	I-TTPs
URL	I-TTPs
string	I-TTPs
(	O
See	O
Example	O
section	O
)	O
.	O
The	O
application	O
should	O
accepts	O
and	O
decodes	O
URL	O
input	O
.	O
The	O
application	O
performs	O
insufficient	B-Vulnerability
filtering/canonicalization	I-Vulnerability
on	I-Vulnerability
the	I-Vulnerability
URLs	I-Vulnerability
.	O
Refer	O
to	O
the	O
RFCs	O
to	O
safely	O
decode	O
URL	O
.	O
Regular	O
expression	O
can	O
be	O
used	O
to	O
match	O
safe	O
URL	O
patterns	O
.	O
However	O
,	O
that	O
may	O
discard	O
valid	O
URL	O
requests	O
if	O
the	O
regular	O
expression	O
is	O
too	O
restrictive	O
.	O
There	O
are	O
tools	O
to	O
scan	O
HTTP	B-Protocol
requests	I-Protocol
to	O
the	O
server	O
for	O
valid	O
URL	O
such	O
as	O
URLScan	B-Application
from	I-Application
Microsoft	I-Application
(	O
http	O
:	O
//www.microsoft.com/technet/security/tools/urlscan.mspx	O
)	O
.	O
Any	O
security	O
checks	O
should	O
occur	O
after	O
the	O
data	O
has	O
been	O
decoded	O
and	O
validated	O
as	O
correct	O
data	O
format	O
.	O
Do	O
not	O
repeat	O
decoding	O
process	O
,	O
if	O
bad	O
character	O
are	O
left	O
after	O
decoding	O
process	O
,	O
treat	O
the	O
data	O
as	O
suspicious	O
,	O
and	O
fail	O
the	O
validation	O
process	O
.	O
Assume	O
all	O
input	O
is	O
malicious	O
.	O
Create	O
a	O
white	O
list	O
that	O
defines	O
all	O
valid	O
input	O
to	O
the	O
software	O
system	O
based	O
on	O
the	O
requirements	O
specifications	O
.	O
Input	O
that	O
does	O
not	O
match	O
against	O
the	O
white	O
list	O
should	O
not	O
be	O
permitted	O
to	O
enter	O
into	O
the	O
system	O
.	O
Test	O
your	O
decoding	O
process	O
against	O
malicious	O
input	O
.	O
Be	O
aware	O
of	O
the	O
threat	O
of	O
alternative	O
method	O
of	O
data	B-TTPs
encoding	I-TTPs
and	O
obfuscation	B-TTPs
technique	O
such	O
as	O
IP	B-TTPs
address	I-TTPs
encoding	I-TTPs
.	O
(	O
See	O
related	O
guideline	O
section	O
)	O
When	O
client	O
input	O
is	O
required	O
from	O
web-based	O
forms	O
,	O
avoid	O
using	O
the	O
``	B-Protocol
GET	I-Protocol
''	I-Protocol
method	I-Protocol
to	O
submit	O
data	O
,	O
as	O
the	O
method	O
causes	O
the	O
form	O
data	O
to	O
be	O
appended	O
to	O
the	O
URL	O
and	O
is	O
easily	O
manipulated	O
.	O
Instead	O
,	O
use	O
the	O
``	O
POST	B-Protocol
method	I-Protocol
whenever	O
possible	O
.	O