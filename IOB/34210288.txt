A
new
file
,
again
with
a
JPEG
extension
(
DSC0001.jpeg
)
,
is
downloaded
and
decrypted
using
the
RSA
and
AES
Cryptographic
Provider
from
WinCrypt
APIs
,
with
a
hardcoded
public
key
.
Then
,
the
malware
dynamically
calls
the
API
NtAllocateVirtualMemory
and
then
writes
and
executes
the
decrypted
content
in
the
newly
allocated
memory
region
.
Similarly
,
the
imported
code
dynamically
calls
VirtualAlloc
to
allocate
a
new
region
of
memory
in
which
a
new
PE
file
is
copied
.
Finally
,
it
passes
the
execution
to
the
region
of
memory
in
which
the
copied
PE
is
allocated
.
