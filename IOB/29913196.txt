Design
:
Do
not
program
input
values
directly
on
command
shell
,
instead
treat
user
input
as
guilty
until
proven
innocent
.
Build
a
function
that
takes
user
input
and
converts
it
to
applications
specific
types
and
values
,
stripping
or
filtering
out
all
unauthorized
commands
and
characters
in
the
process
.
Design
:
Limit
program
privileges
,
so
if
metacharacters
or
other
methods
circumvent
program
input
validation
routines
and
shell
access
is
attained
then
it
is
not
running
under
a
privileged
account
.
chroot
jails
create
a
sandbox
for
the
application
to
execute
in
,
making
it
more
difficult
for
an
attacker
to
elevate
privilege
even
in
the
case
that
a
compromise
has
occurred
.
Implementation
:
Implement
an
audit
log
that
is
written
to
a
separate
host
,
in
the
event
of
a
compromise
the
audit
log
may
be
able
to
provide
evidence
and
details
of
the
compromise
.
